pipeline {
    agent any



    tools {
        jdk 'JAVA_HOME'      
        maven 'MAVEN_HOME'   
    }

    stages {
        stage('Prepare workspace & checkout') {
            steps {
                
                bat '''
                    if exist SEInternal (
                        rmdir /s /q SEInternal
                    )
                '''
               
                git url: 'https://github.com/RachaPranavanadh/SEInternal.git', branch: 'main'
            }
        }

        stage('Clean') {
            steps {
                
                bat 'mvn -f pom.xml clean'
            }
        }

        stage('Install') {
            steps {
                bat 'mvn -f pom.xml install -DskipTests=false'
            }
        }

        stage('Test') {
            steps {
                bat 'mvn -f pom.xml test'
            }
        }

        stage('Package') {
            steps {
                bat 'mvn -f pom.xml package'
            }
        }
    }

    post {
        always {
            
            archiveArtifacts artifacts: 'SEInternal/target/*.jar', allowEmptyArchive: true
            junit testResults: 'SEInternal/target/surefire-reports/*.xml', allowEmptyResults: true
        }
    }
}
version:3.8\nweb:\nservices\nimage:nginx\nports:\n - "8082:80"\n db:\nimage:postgres:15\nenv:\n POSTGRES_USER:demo\n
